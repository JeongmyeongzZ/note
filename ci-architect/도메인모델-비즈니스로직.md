# 도메인모델

ERD, 클래스 다이어그램과 같은게 도메인 모델이라고 생각하고 있었다. 데이터 중심으로만 설계하고 데이터 중심으로만 사고하고 개발했기 때문에 그런 것 같다.

리소스 단위로 Endpoint 들을 설계하고, 그에 맞는 MVC + S 와 같은 기본적인 레이어드 아키텍처로 구현하는게 정답이고 이렇게 개발 하는 것 같았다.

도메인모델을은 실제로 객체 설계 모습에 가깝다. 단순히 데이터 관점에서 작성한 Entity, Model 과는 다르다는 것이다.

정보처리 기사를 공부했을 때 보던 데이터 모델링 중 개념적 모델링과 비슷 한 것 같다. (개논물이라고 외웠었는데.. 개념적 논리적 물리적..) 추상적으로 엔티티들을 설계하고, E-R 다이어그램을 구성하는 것과 같은..

여기서 도메인은 우리가 해결해야되는 문제로 봐도 좋고, 개발해야되는 범위나 대상으로 볼 수도 있다.

도메인 모델이라고 하면 정적 데이터 요소를 표현하는 것으로 국한하는 것 같은데 동적인 요소(예를 들어 유즈 케이스)까지 고려가 되어야 한다고 한다.

도메인 모델을 객체로만 모델링 할 수 있는 것은 아니며 상태 다이어그램을 이용해서 상태 전이도 함께 모델링할 수 있다.


---

'도메인 모델'이란 용어는 도메인 자체를 표현하는 개념적인 모델을 의미하지만, 도메인 계층을 구현할 때 사용하는 객체 모델을 언급할 때에도 '도메인 모델'이란 용어를 사용한다.

흔히 사용하는 레이어드에서, 도메인 / 애플리케이션 / 프레젠테이션 / 인프라스트럭처중 도메인 계층으로 얘기하면 이렇다.

도메인 계층은 도메인의 핵심 규칙을 구현한다. 주문 도메인의 경우 '출고 전에 배송지를 변경할 수 있다'는 규칙과 '주문 취소는 배송 전에만 할 수 있다'는 규칙을 구현한 코드가 도메인 계층에 위치하게 된다.


```
public class Order {
	private ShippingInfo shippingInfo;

	public void changeShippingInfo(ShippingInfo newShippingInfo) {
		if (!state.isShippingChangeable()) {
			throw new IllegalStateException("can't change shipping in " + state);
		}
		this.shippingInfo = newShippingInfo;
	}
}
```


# 비즈니스로직

도메인 레이어에서 비즈니스 로직을 처리한다, 비즈니스 로직은 Model(Domain)에 가까울수록 좋다 등 이런 말을 들어볼 수 있는데, 그럼 비즈니스 로직은 무엇일까

presentation tier(client tier), logic tier(application tier), data tier 로 나눠진 three-tier architecture 를 한 번쯤 들어봤을 것이다. (3계층 구조)

이 중 로직 계층 (애플리케이션 계층) 이라고 이해하는게 가장 편했다. (아직 내가 제대로 된 이해를 하지 못했을 수도 ..)

유저가 어떠한 액션을 취하고, 백단 서비스에서 유저의 입력값에 대한 검증, 입력값에 해당하는 데이터 조회, 유저가 머무는 화면으로 응답을 전달해주는 것 과 같은 일련의 행동들이 이곳에 포함된다.



비즈니스 로직은 Servier Layer에서 처리되어야 한다고 배웠다. 하지만 Domain Layer에서 비즈니스 로직이 처리되어야 좋다고한다.

Service Layer에서는 트랜잭션과 도메인 간의 순서만을 보장한다. 

-> 서비스 단의 복잡도를 낮추는 효과를 얻을 수 있다.

복잡도를 낮춤으로써 유지보수와 테스트하기 쉬운 코드가 생기고 결국엔 유연한 Software를 얻을 수 있습니다.

이는 트랜잭션 스크립트 패턴이 아닌, 도메인 모델 패턴에 가깝고, 이 것이 포인트이다.

**핵심 규칙을 구현한 코드는 도메인 모델에만 위치하기 때문에 규칙이 바뀌거나 규칙을 확장해야 할 때 다른 코드에 영향을 덜 주고 변경 내역을 모델에 반영할 수 있게 된다.**



_참고_
- _https://incheol-jung.gitbook.io/docs/study/ddd-start/1_
- _https://javacan.tistory.com/entry/what-is-a-domain-model_
